model patch_char {
  id                   Int      @id @default(autoincrement())

  patch_id             Int
  patch                patch    @relation(fields: [patch_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  source               String   @db.VarChar(31)
  kind                 String   @db.VarChar(31)

  vndb_char_id         String?  @db.VarChar(32)
  vndb_staff_id        String?  @db.VarChar(32)
  bangumi_person_id    Int?
  bangumi_character_id Int?

  name                 String   @db.VarChar(1007)
  name_zh_cn           String   @default("") @db.VarChar(1007)
  name_ja_jp           String   @default("") @db.VarChar(1007)
  name_en_us           String   @default("") @db.VarChar(1007)
  alias                String[]

  gender               String?  @db.VarChar(31)
  blood_type           Int?
  birth_year           Int?
  birth_mon            Int?
  birth_day            Int?

  image                String?  @db.VarChar(1007)
  image_small          String?  @db.VarChar(1007)
  image_medium         String?  @db.VarChar(1007)
  image_large          String?  @db.VarChar(1007)
  image_grid           String?  @db.VarChar(1007)

  description          String?  @db.VarChar(100007)
  description_zh_cn    String?  @db.VarChar(100007)
  description_ja_jp    String?  @db.VarChar(100007)
  description_en_us    String?  @db.VarChar(100007)

  // main / supporting / voice / scenario / artist
  roles                String[]

  created              DateTime @default(now())
  updated              DateTime @updatedAt

  infobox     patch_char_infobox? @relation("patch_char_infobox")

  @@index([patch_id])
  @@index([source])
  @@index([kind])
  @@unique([patch_id, vndb_char_id])
  @@unique([patch_id, vndb_staff_id])
  @@unique([patch_id, bangumi_person_id])
  @@unique([patch_id, bangumi_character_id])
}

model patch_char_infobox {
  id            Int        @id @default(autoincrement())

  patch_char_id Int   @unique
  char          patch_char @relation(name: "patch_char_infobox", fields: [patch_char_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  key           String     @db.VarChar(233)
  value         String     @db.VarChar(1007)
  order_no      Int        @default(0)

  created       DateTime   @default(now())
  updated       DateTime   @updatedAt

  @@index([patch_char_id])
  @@index([key])
  @@unique([patch_char_id, key, order_no])
}

